---
title: 性能考虑，数组是首选
date: 2017-01-11 20:31:30
tags:
categories: "Java学习笔记"
---

### 一、分析

数组在实际的系统开发中使用的越来越少，我们通常只有在阅读一些开源项目时才会看到它们的身影，在Java中它确实没有List、Set、Map这些集合使用起来方便，但是在基本类型处理方面，数组还是占优势的，而且集合的底层也是通过数组实现。

### 二、场景

比如对一个数据集求和的计算：

```java
//对数组求和
public static int sum(int[] datas){
    int sum = 0;
    for(int i = 0; i < datas.length; i++){
        sum += datas[i];
    }
    return sum;
}
```

对于一个int类型的数组求和，取出所有元素的数组元素并相加，此算法是基本类型则使用数组效率最高。

<!--more-->

```java
//对列表求和计算
public static int sum(List<Integer> datas){
    int sum = 0;
    for(int i = 0; i < datas.size(); i++){
        sum += datas.get(i);
    }
    return sum;
}
```

注意在相加求和的运算中，做了一个拆箱动作，这对于性能濒于临界的系统是比较危险的。

在初始化List的时候，要进行装箱动作，虽然有整形池在，但不在整形池范围都会产生一个新的Integer对象。

众所周知，基本类型是在栈内存操作的，而对象则是在堆内存中操作的。栈内存的特点是速度快，容量小；堆内存的特点是速度慢，容量大（从性能上讲，基本类型的处理占优势）。

### 三、建议

性能要求较高的场景中，使用数组替代集合。在实际测试中发现：对于基本类型进行求和计算时，数组的效率是集合的10倍。
