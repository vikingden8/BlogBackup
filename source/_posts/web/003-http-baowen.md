---
title: HTTP报文的组成
date: 2017-01-15 20:46:47
tags:
categories: "Web学习笔记"
---

HTTP报文是简单的格式化数据块。每条报文都包含一条来自客户端的请求，或者一条来自服务器端的响应。它们由三部分组成：对报文进行描述的起始行（start line）、包含属性的首部块（header），以及可选的、包含数据的主体部分（body）。如下图：

![](/images/categories/web/http_message_01.png)

起始行和首部就是由行分隔的ASCII文本。每行都以一个由两个字符组成的行终止序列作为结束。其中包括一个回车符（ASCII码13）和一个换行符（ASCII码10）。这个行终止序列可以写做CRLF。需要指出的是，尽管HTTP规范中说明应该用CRLF来表示行终止，但稳健的应用程序也应该接受单个换行符作为行的终止。有些老的，或不完整的HTTP应用程序并不总是既发送回车符，又发送换行符。

实体的主体或报文的主体是一个可选的数据块。与起始行和首部不同的是，主体中可以包含文本或二进制数据，也可以为空。

如上图的例子，首部给出了一些与主体相关的信息。Content-Type行说明了主体是什么--在这个例子中，就是纯文本文档。Content-Length行说明了主体有多大，在这里就只有19个字节。

<!--more-->

#### 报文的语法

所有的HTTP报文都可以分为两类：请求报文（request-message）和响应报文（response-message）。请求报文会向WEB服务器请求一个动作，响应报文会将请求的结果返回给客户端。请求和响应报文的基本报文结构相同。

![](/images/categories/web/http_message_02.png)

如下是请求报文的格式：

![](/images/categories/web/http_message_03.png)

如下是响应报文的格式：

![](/images/categories/web/http_message_04.png)

下面是对各部分的简单描述：

* **方法（method）**
  客户端希望服务器对资源执行的动作。是一个单独的词，比如GET，HEAD或者POST等。

* **请求URL（request URL）**
  命名了所请求的资源，或者URL路径组件的完整URL。如果直接与服务器进行对话，只要URL的路径组件是资源的绝对路径，通常就不会有什么问题--服务器可以假定自己是URL的主机/端口。

* **版本（version）**
  报文所使用的HTTP版本，格式：HTTP/<major>.<minor>，其中主要版本号（major）和次要版本号（minor）都是整数。

* **状态码（status-code）**
  这三位数字描述了请求过程中所发生的情况。每个状态码的第一位数字都用于描述状态的一般类别（如成功、错误等）。

* **原因短语（reason-phrase）**
  数字状态码的可读版本，包含行终止序列之前的所有文本。

* **首部（header）**
  可以有零个或多个首部，每个首部都包含一个名字，后面跟着一个冒号（：），然后是一个可选的空格，接着是一个值，最后是一个CRLF。首部是由一个空行（CRLF）结束的，表示了首部列表的结束和实体主体部分的开始。有些HTTP版本，比如HTTP/1.1，要求有效的请求或者响应报文中必须包含特定的首部。

* **实体的主体部分（entity-body）**
  实体的主体部分包含一个由任意数据组成的数据块。并不是所有的报文都包含实体的主体部分，有时，报文只是以一个CRLF结束。

请求和响应报文示例，如下图：

![](/images/categories/web/http_message_05.png)

注意，一组HTTP首部总是应该以一个空行（单个CRLF）结束，甚至即使没有首部和实体的主体部分也应如此。但由于历史原因，很多客户端和服务器都在没有实体的主体部分时，（错误地）省略了最后的CRLF。为了与这些流行但不符合规则的实现进行互通，客户端和服务器都应该接受那些没有最后那个CRLF的报文。
